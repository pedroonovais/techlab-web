<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/header :: head(${iot.id} == null ? 'Novo IoT' : 'Editar IoT')}"></head>

<body class="bg-gray-900 text-white min-h-screen flex flex-col font-sans">
    <!-- Header -->
    <nav th:replace="~{fragments/header :: navbar}"></nav>

    <main class="flex-1 mx-auto w-full max-w-lg px-4 sm:px-6 lg:px-8 py-6">
        <h1 class="text-2xl font-bold mb-4" th:text="${iot.id} == null ? 'Cadastrar IoT' : 'Editar IoT'">Cadastrar IoT
        </h1>

        <!-- Mensagem (flash) -->
        <div th:if="${message}" class="rounded-lg border border-cyan-700 bg-cyan-900/40 text-cyan-200 px-4 py-3 mb-4"
            th:text="${message}">
        </div>

        <form th:object="${iot}" th:action="@{/iot/form}" method="post"
            class="rounded-xl bg-gray-800 border border-gray-700 shadow-2xl p-6 space-y-5">

            <!-- CSRF -->
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <!-- ID (somente quando editar) -->
            <input type="hidden" th:if="${iot.id} != null" th:field="*{id}" />

            <!-- Ativo -->
            <div>
                <label class="block text-sm font-medium text-gray-400 mb-1">Status</label>
                <div class="flex items-center gap-2">
                    <input id="ativo" type="checkbox" th:field="*{ativo}"
                        class="h-4 w-4 rounded border-gray-600 bg-gray-700 text-green-500 focus:ring-cyan-500">
                    <label for="ativo" class="text-sm text-gray-300">Ativo</label>
                </div>
                <p class="text-sm text-red-400 mt-1" th:if="${#fields.hasErrors('ativo')}" th:errors="*{ativo}">Erro</p>
            </div>

            <!-- Bateria (opcional) -->
            <div>
                <label for="bateria" class="block text-sm font-medium text-gray-400 mb-1">Bateria (%)</label>
                <input id="bateria" type="number" min="0" max="100" th:field="*{bateria}" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white
                      focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500"
                    placeholder="0 a 100 (opcional)">
                <p class="text-sm text-red-400 mt-1" th:if="${#fields.hasErrors('bateria')}" th:errors="*{bateria}">Erro
                </p>
            </div>

            <!-- Coordenada X -->
            <div>
                <label for="coordenadaX" class="block text-sm font-medium text-gray-400 mb-1">Coordenada X</label>
                <input id="coordenadaX" th:field="*{coordenadaX}" autocomplete="off" required class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-500
                      focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500"
                    placeholder="Ex.: -23.5505">
                <p class="text-sm text-red-400 mt-1" th:if="${#fields.hasErrors('coordenadaX')}"
                    th:errors="*{coordenadaX}">Erro</p>
            </div>

            <!-- Coordenada Y -->
            <div>
                <label for="coordenadaY" class="block text-sm font-medium text-gray-400 mb-1">Coordenada Y</label>
                <input id="coordenadaY" th:field="*{coordenadaY}" autocomplete="off" required class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-500
                      focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500"
                    placeholder="Ex.: -46.6333">
                <p class="text-sm text-red-400 mt-1" th:if="${#fields.hasErrors('coordenadaY')}"
                    th:errors="*{coordenadaY}">Erro</p>
            </div>

            <!-- Ações -->
            <div class="flex flex-col sm:flex-row gap-2 sm:justify-end">
                <a href="/iot" class="px-4 py-2 rounded-md border border-gray-600 bg-gray-700 hover:bg-gray-600 text-white
                  transition-colors text-center">
                    Cancelar
                </a>
                <button type="submit" class="px-4 py-2 rounded-md bg-green-600 hover:bg-green-700 text-gray-900 font-semibold
                       focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-gray-900
                       transition-colors">
                    <span th:text="${iot.id} == null ? 'Salvar' : 'Atualizar'">Salvar</span>
                </button>
            </div>
        </form>
    </main>

    <div th:replace="~{fragments/footer :: footer}"></div>
</body>

</html>